{"metadata":{},"options":{"plugins":[{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"base$0$2","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"polyfill":false,"useBuiltIns":false}},{"key":"base$0$3","visitor":{"_exploded":{},"_verified":{},"PrivateName":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$4","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$5","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$6","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"base$0$1$0","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"base$0$1$1","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$2","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$3","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$4","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$5","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$6","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$7","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$8","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$9","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$10","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$11","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$12","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$13","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$14","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$15","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$16","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$17","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$18","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$19","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$20","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$21","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$0$22","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$23","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]}},"options":{}}],"presets":[],"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/farid/Documents/Projects/Meteor/justadit/client/templates/seller.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining","pipelineOperator","throwExpressions","dynamicImport","classProperties","classPrivateProperties","jsx",["flow",{}],"asyncGenerators","objectRestSpread","objectRestSpread",["flow",{}],"asyncGenerators"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"strictMode":false},"sourceFileName":"client/templates/seller.js","filename":"/Users/farid/Documents/Projects/Meteor/justadit/client/templates/seller.js","passPerPreset":false,"envName":"development","cwd":"/Users/farid/Documents/Projects/Meteor/justadit","root":"/Users/farid/Documents/Projects/Meteor/justadit","generatorOpts":{"filename":"/Users/farid/Documents/Projects/Meteor/justadit/client/templates/seller.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/templates/seller.js"}},"code":"Template.SellerProducts_tmp.helpers({\n  'myProducts': function () {\n    console.log(\"This sellers products:\" + Meteor.userId());\n    Loading.call(\"getSellerProducts\", [], [], [], function (error, result) {\n      if (error) {\n        console.log(\"Error getting seller products \" + error);\n      } else {\n        // console.log(\"Got it\");\n        // console.log(result);\n        Session.set(\"SellerProducts\", result);\n      }\n    });\n    return Session.get(\"SellerProducts\");\n  }\n});\nTemplate.Seller_tmp.helpers({\n  amISeller: function () {\n    if (Meteor.userId()) {\n      console.log(\" Client Checking  for seller : \" + Meteor.userId());\n      Meteor.subscribe('getSeller', Meteor.userId());\n      var result = {\n        _id: \"\",\n        userId: Meteor.userId(),\n        businessname: \"\",\n        busTagLine: \"\",\n        busLogo: \"\",\n        busAvatar: \"\",\n        bustel: \"\",\n        buscel: \"\",\n        busemail: \"\",\n        cont1: \"\",\n        cont2: \"\",\n        add1: \"\",\n        add2: \"\",\n        add3: \"\",\n        add4: \"\",\n        add5: \"\",\n        website: \"\"\n      };\n\n      if (Sellers.find({\n        userId: Meteor.userId()\n      }).count() === 0) {\n        console.log(\"Seller not found\");\n      } else {\n        result = Sellers.findOne({\n          userId: Meteor.userId()\n        });\n      }\n\n      return result;\n    }\n  }\n});\nTemplate.seller.onRendered(function () {\n  console.log(\"Create Seller template\");\n});\nTemplate.tmp_product_sell.onRendered(function () {});\nTemplate.tmp_product_sell.events({\n  'change .prodImg': function (event, template) {\n    event.preventDefault();\n    var fr = new FileReader();\n    document.getElementById('prdImages').innerHTML = \"\";\n    var fileCount = event.currentTarget.files.length;\n\n    if (fileCount > 5) {\n      alert('Oh No Too Many files , please select 5 or less');\n      event.currentTarget = \"\";\n      return false;\n    }\n\n    var isToBig = false;\n    var uploadSize = 0;\n\n    for (i = 0; i < fileCount; i++) {\n      console.log(\"Processing files \" + event.currentTarget.files[i].name); //document.querySelector('imgProgress').outerHTML=\"<span>Processing file \"+ event.currentTarget.files[i].name +\"</span>\";\n\n      HandleClientImageFile(event.currentTarget.files[i], \"prdImages\"); //  if (event.currentTarget.files[i].size < 2000000)\n      //   {\n      //     HandleClientImageFile(event.currentTarget.files[i],\"prdImages\");\n      //     uploadSize=+event.currentTarget.files[i].size;        \n      //   }\n      //   else\n      //   {\n      //     isToBig = true;\n      //   }\n    } // if (isToBig)\n    // {\n    //   alert('Some files have been removed , as they exceed the 2MB limit.');\n    // }\n    // document.querySelector('imgProgress').outerHTML=\"<span>Processing Complete. Payload size \"+ uploadSize +\"</span>\";\n\n\n    event.currentTarget = \"\"; //event.currentTarget.setAttribute(\"multiple\",\"multiple\");\n    //event.currentTarget.setAttribute(\"class\",\"fileUpload\");              \n  }\n});\nTemplate.seller.events({\n  'change .imgBuLogo': function (event, template) {\n    event.preventDefault();\n    console.log('Add Seller BusLogo Upload');\n    Loading.start();\n    var fr = new FileReader();\n\n    fr.onload = function (event) {\n      var data = event.target.result;\n      template.$('.imgBusLogo')[0].src = data;\n    };\n\n    fr.readAsDataURL(event.currentTarget.files[0]);\n    Loading.stop();\n  },\n  'change .imgAvatar': function (event, template) {\n    event.preventDefault();\n    var fr = new FileReader();\n\n    fr.onload = function (event) {\n      var data = event.target.result;\n      template.$('.imgBusAvatar')[0].src = data;\n    };\n\n    if (event.currentTarget.files[0].size < 2000000) {\n      fr.readAsDataURL(event.currentTarget.files[0]);\n    } else {\n      template.$('.imgBusAvatar')[0].src = \"/img/app/big.jpg\";\n    }\n  },\n  'submit .add_Seller_form': function (event, template) {\n    event.preventDefault();\n    target = event.target; //'seller.add'(excel) { \n\n    Loading.start();\n    businessname = target.businessname.value;\n    busTagLine = target.businesstagLine.value;\n    busLogo = target.imgBusLogo.src; //busAvatar= target.imgBusAvatar.src;\n\n    bustel = target.bustell.value;\n    buscel = target.buscell.value;\n    busemail = target.busemail.value;\n    cont1 = target.person1.value;\n    cont2 = target.person2.value;\n    add1 = target.add1.value;\n    add2 = target.add2.value;\n    add3 = target.add3.value;\n    add4 = target.add4.value;\n    add5 = target.add5.value;\n    website = target.website.value;\n    var busLogoFile = target.fileLogo.files;\n    var randLogoId = Random.id();\n    var buslogImdId = Random.id();\n\n    if (busLogoFile.length > 0) {\n      var BuslogoImg = new FS.File(busLogoFile[0]);\n      BuslogoImg.sellerId = Meteor.userId();\n      BuslogoImg.ImageCat = \"SellerDetails\";\n      BuslogoImg.ImageType = \"BusLogo\";\n      BuslogoImg.ImageId = randLogoId;\n\n      try {\n        Images.insert(BuslogoImg, function (err, fileObj) {\n          if (err) {} // Inserted new doc with ID fileObj._id, and kicked off the data upload using HTTP\n\n        });\n      } catch (error) {}\n    }\n\n    createDate = Date.now().toLocaleString();\n\n    if (target.currentuser === null) {\n      alert('You must be logged in to be a seller');\n      return false;\n    }\n\n    var SellerObj = {\n      //_id:this._id,\n      userId: Meteor.userId(),\n      businessname: target.businessname.value,\n      busTagLine: target.businesstagLine.value,\n      busLogo: randLogoId,\n      //busAvatar: randAvaId,\n      bustel: target.bustell.value,\n      buscel: target.buscell.value,\n      busemail: target.busemail.value,\n      cont1: target.person1.value,\n      cont2: target.person2.value,\n      add1: target.add1.value,\n      add2: target.add2.value,\n      add3: target.add3.value,\n      add4: target.add4.value,\n      add5: target.add5.value,\n      website: target.website.value // Loading.start();\n\n    };\n    var result = Meteor.call('newSeller', SellerObj, function (err) {\n      if (err) {\n        console.log(err);\n        alert('OOps something went wrong adding new seller, please retry .');\n      } else {\n        //clean up form   \n        try {} catch (exp) {\n          console.log(exp);\n        }\n      }\n    });\n    Loading.stop();\n  }\n});\n\nfunction HandleClientImageFile(file, targetElement) {\n  var preview = document.querySelector(\"#\" + targetElement);\n  var fr = new FileReader(); //insertImg.name=\"imgprds\";\n\n  if (file.name === null) {\n    return null;\n  }\n\n  fr.onload = function (event) {\n    var data = event.target.result;\n    var insertImg = new Image();\n    insertImg.id = \"prdImages\"; //insertImg.style =\"height=100%;width=100%\"; \n\n    insertImg.className = \"prdImages img-responsive\";\n    insertImg.src = data;\n    var image = new Image();\n    var compressedImage = new Image();\n\n    image.onload = function () {\n      var canvas = document.createElement(\"canvas\");\n      canvas.width = insertImg.naturalWidth;\n      canvas.height = insertImg.naturalHeight;\n      var ctx = canvas.getContext(\"2d\").drawImage(insertImg, 0, 0); //,insertImg.naturalWidth,insertImg.naturalHeight, 0, 0,insertImg.naturalWidth,insertImg.naturalHeight);\n\n      compressedImage.width = insertImg.naturalWidth;\n      compressedImage.height = insertImg.naturalHeight;\n      var compressValue = 1 / 100;\n\n      switch (true) {\n        case file.size < 400000:\n          compressValue = 100 / 100;\n          break;\n\n        case file.size < 800000:\n          compressValue = 80 / 100;\n          break;\n\n        case file.size < 2000000:\n          compressValue = 60 / 100;\n          break;\n\n        case file.size < 4000000:\n          compressValue = 40 / 100;\n          break;\n\n        case file.size < 6000000:\n          compressValue = 20 / 100;\n          break;\n\n        default:\n          compressValue = 10 / 100;\n          break;\n      }\n\n      compressedImage = canvas.toDataURL(\"image/jpeg\", compressValue);\n      var newImg = new Image(); //newImg.height =1000;\n\n      newImg.id = \"prdImages\";\n      newImg.src = compressedImage;\n      newImg.className = \"prdImages img-responsive\";\n      preview.appendChild(newImg);\n    };\n\n    image.src = data; //var compImage = compressImage(image,40,\"jpg\");\n    //insertImg.src = data;    \n    //preview.appendChild(insertImg);    \n  };\n\n  fr.readAsDataURL(file);\n}\n\nfunction compressImage(source_img_obj, quality, output_format) {\n  var mime_type = \"image/jpeg\";\n\n  if (typeof output_format !== \"undefined\" && output_format == \"png\") {\n    mime_type = \"image/png\";\n  }\n\n  var cvs = document.createElement('canvas');\n  cvs.style.width = source_img_obj.naturalWidth;\n  cvs.style.height = source_img_obj.naturalHeight; //ctx.drawImage(img,0,0,img.width,img.height,0,0,400,300);\n\n  var ctx = cvs.getContext(\"2d\").drawImage(source_img_obj, 0, 0, source_img_obj.naturalHeight, source_img_obj.naturalWidth, 0, 0, source_img_obj.naturalHeight, source_img_obj.naturalWidth);\n  var newImageData = cvs.toDataURL(mime_type, quality / 100);\n  var result_image_obj = new Image();\n  result_image_obj.src = newImageData;\n  result_image_obj.style.height = source_img_obj.naturalWidth;\n  result_image_obj.style.width = source_img_obj.naturalHeight;\n  return result_image_obj;\n}\n\nfunction HandleClientImageData(file, targetElement) {\n  var preview = document.querySelector(\"#\" + targetElement); //insertImg.name=\"imgprds\";\n\n  if (file === null) {\n    return null;\n  }\n\n  var data = file;\n  var insertImg = new Image();\n  insertImg.id = \"prdImages\";\n  insertImg.style = \"height=100%;width=100%\";\n  insertImg.className = \"prdImages img-responsive\";\n  insertImg.src = data;\n  preview.appendChild(insertImg);\n}\n\nif (Meteor.isClient) {\n  Template.tmp_product_sell.events({\n    'submit .product-link-add': function (event) {\n      var thisForm = $('.product-link-add');\n      thisForm.validate();\n      event.preventDefault();\n\n      try {\n        var productImages = event.target.prodImg.files;\n        var compressedImages = $('.prdImages');\n        var prodimgId = Random.id();\n        var saveId;\n\n        if (productImages.length > 0) {\n          for (var i = 0; i < productImages.length; i++) {\n            var fr = new FS.File(compressedImages[i].src);\n            Loading.start();\n            var productImg = new FS.File(productImages[i]);\n            fr.name = productImg.name;\n            fr.extension = productImg.extension;\n            fr.type = productImg.type;\n            fr.sellerId = Meteor.userId();\n            fr.ImageCat = \"ProductImage\";\n            fr.ImageType = \"ProductDisplay\";\n            fr.ImageId = prodimgId; //template.$('.imgBusLogo')[0].src = data;    \n\n            saveId = Images.insert(fr, function (err, fileObj) {// Inserted new doc with ID fileObj._id, and kicked off the data upload using HTTP\n            });\n            Loading.stop(); // var productImg = new FS.File(productImages[i]);\n            // // if (productImg.size() < 1000000)\n            // // {\n            //   productImg.data = compressedImages[i].src;\n            //   productImg.sellerId = Meteor.userId();\n            //   productImg.ImageCat = \"ProductImage\";\n            //   productImg.ImageType = \"ProductDisplay\";\n            //   productImg.ImageId = prodimgId ;\n            // }\n          }\n        }\n      } catch (error) {\n        console.log(\"Error inserting Product Images\");\n        Loading.halt();\n      }\n\n      var ImagesInserted = prodimgId; //debugger;\n\n      var target = event.target;\n      var title = target.prdTitle.value;\n      var description = target.prdDesc.value;\n      var img = ImagesInserted;\n      var price = target.prdprice.value;\n      var prdCat = target.prdCat.value;\n      var createDate = new Date();\n      var expireValue = target.prdExpire.value;\n      var expireDate = new Date();\n      console.log(description);\n      var timetoadd = ReferenceData.findOne({\n        name: \"addTime\",\n        id: expireValue\n      }).timetoadd;\n      var expDate = new Date(); //Date.parse(expDate.format());// moment().add(timetoadd,'days');\n\n      var myExpDate = new Date(); // Date.parse(expDate.format());\n\n      var prodObj = {\n        sellerId: Meteor.userId(),\n        producttitle: title,\n        productDescription: description,\n        price: price,\n        prdCat: prdCat,\n        prodImg: img,\n        createdAt: createDate,\n        expireAt: new Date(myExpDate) // Here we need to get the images that have been selected to be uploaded to the server\n\n      };\n\n      try {\n        Loading.call(\"products.insert\", prodObj, [], [], function (error, result) {\n          if (error) {\n            alert('Something went wrong. Please try again.');\n          } else {//clear form.\n          }\n        });\n      } catch (error) {\n        console.log(\"Error Inserting product\");\n      }\n    }\n  });\n}","map":{"version":3,"sources":["client/templates/seller.js"],"names":["Template","SellerProducts_tmp","helpers","console","log","Meteor","userId","Loading","call","error","result","Session","set","get","Seller_tmp","amISeller","subscribe","_id","businessname","busTagLine","busLogo","busAvatar","bustel","buscel","busemail","cont1","cont2","add1","add2","add3","add4","add5","website","Sellers","find","count","findOne","seller","onRendered","tmp_product_sell","events","event","template","preventDefault","fr","FileReader","document","getElementById","innerHTML","fileCount","currentTarget","files","length","alert","isToBig","uploadSize","i","name","HandleClientImageFile","start","onload","data","target","$","src","readAsDataURL","stop","size","value","businesstagLine","imgBusLogo","bustell","buscell","person1","person2","busLogoFile","fileLogo","randLogoId","Random","id","buslogImdId","BuslogoImg","FS","File","sellerId","ImageCat","ImageType","ImageId","Images","insert","err","fileObj","createDate","Date","now","toLocaleString","currentuser","SellerObj","exp","file","targetElement","preview","querySelector","insertImg","Image","className","image","compressedImage","canvas","createElement","width","naturalWidth","height","naturalHeight","ctx","getContext","drawImage","compressValue","toDataURL","newImg","appendChild","compressImage","source_img_obj","quality","output_format","mime_type","cvs","style","newImageData","result_image_obj","HandleClientImageData","isClient","thisForm","validate","productImages","prodImg","compressedImages","prodimgId","saveId","productImg","extension","type","halt","ImagesInserted","title","prdTitle","description","prdDesc","img","price","prdprice","prdCat","expireValue","prdExpire","expireDate","timetoadd","ReferenceData","expDate","myExpDate","prodObj","producttitle","productDescription","createdAt","expireAt"],"mappings":"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","sourcesContent":["\n\nTemplate.SellerProducts_tmp.helpers({\n  'myProducts':function(){\n    console.log(\"This sellers products:\" + Meteor.userId());\n\n    Loading.call(\"getSellerProducts\", [], [], [], function (error, result){\n      if (error)\n      {\n        console.log(\"Error getting seller products \" + error) ;\n      }\n      else\n      {\n        // console.log(\"Got it\");\n        // console.log(result);\n        Session.set(\"SellerProducts\",result);\n      }\n    });\n    \n    \n    return Session.get(\"SellerProducts\");\n  }\n})\n\nTemplate.Seller_tmp.helpers({\n   \n    amISeller: function() {\n      if (Meteor.userId())\n\n      {\n    \n        console.log(\" Client Checking  for seller : \" + Meteor.userId());\n        Meteor.subscribe('getSeller',Meteor.userId());\n         \n        var result =  {\n          _id:\"\",\n           userId:Meteor.userId(),\n           businessname : \"\",\n           busTagLine: \"\",\n           busLogo: \"\",\n           busAvatar: \"\",\n           bustel: \"\",\n           buscel: \"\",\n           busemail: \"\",\n           cont1 : \"\",\n           cont2 : \"\",\n           add1: \"\",\n           add2: \"\",\n           add3: \"\",\n           add4: \"\",\n           add5: \"\",\n           website: \"\"\n          };\n        if (Sellers.find({userId:Meteor.userId()}).count() === 0)\n        {\n          console.log(\"Seller not found\");\n        }        \n        else\n        {\n          result = Sellers.findOne({userId:Meteor.userId()});          \n        }  \n       return result;\n         \n      }\n        \n        \n    },\n    \n});\n\nTemplate.seller.onRendered(function() {\n  console.log(\"Create Seller template\");\n  \n \n \n  \n \n  });\n\n  Template.tmp_product_sell.onRendered(function(){\n   \n     \n  });\n\n  Template.tmp_product_sell.events({\n    'change .prodImg' :function (event,template)\n    {     \n      event.preventDefault();\n      \n      var fr=new FileReader();   \n      document.getElementById('prdImages').innerHTML = \"\";\n \n      var fileCount = event.currentTarget.files.length;\n      \n      if (fileCount > 5)\n      {\n        alert('Oh No Too Many files , please select 5 or less');\n        event.currentTarget  =\"\";        \n        return false;\n      }\n      var isToBig = false;\n      var uploadSize =0;\n      for (i=0 ; i < fileCount ; i++)\n      {\n        console.log(\"Processing files \" + event.currentTarget.files[i].name);\n         //document.querySelector('imgProgress').outerHTML=\"<span>Processing file \"+ event.currentTarget.files[i].name +\"</span>\";\n         HandleClientImageFile(event.currentTarget.files[i],\"prdImages\");\n        //  if (event.currentTarget.files[i].size < 2000000)\n        //   {\n        //     HandleClientImageFile(event.currentTarget.files[i],\"prdImages\");\n        //     uploadSize=+event.currentTarget.files[i].size;        \n        //   }\n        //   else\n        //   {\n        //     isToBig = true;\n        //   }\n      }\n\n      // if (isToBig)\n      // {\n      //   alert('Some files have been removed , as they exceed the 2MB limit.');\n      // }\n     // document.querySelector('imgProgress').outerHTML=\"<span>Processing Complete. Payload size \"+ uploadSize +\"</span>\";\n      \n     event.currentTarget  = \"\";\n     //event.currentTarget.setAttribute(\"multiple\",\"multiple\");\n     //event.currentTarget.setAttribute(\"class\",\"fileUpload\");              \n    }\n  });\n\nTemplate.seller.events({\n   \n    'change .imgBuLogo' :function (event,template)\n    { \n     event.preventDefault();     \n        console.log('Add Seller BusLogo Upload');\n        Loading.start();\n      \n      var fr=new FileReader();        \n      fr.onload=function(event){\n              \n              var data=event.target.result;      \n              template.$('.imgBusLogo')[0].src = data;    \n      }      \n      fr.readAsDataURL(event.currentTarget.files[0]);  \n      \n      Loading.stop();\n    },\n    'change .imgAvatar' :function (event,template)\n    { \n      event.preventDefault();        \n      \n      var fr=new FileReader();        \n      fr.onload=function(event){\n              var data=event.target.result;                            \n              template.$('.imgBusAvatar')[0].src = data;          \n      }\n      if (event.currentTarget.files[0].size < 2000000)\n      {\n       fr.readAsDataURL(event.currentTarget.files[0]);          \n      }\n      else\n      {\n        template.$('.imgBusAvatar')[0].src = \"/img/app/big.jpg\";  \n      }  \n    },\n    'submit .add_Seller_form' :function (event,template)\n    {       \n      \n      event.preventDefault();\n       target = event.target;\n      //'seller.add'(excel) { \n        Loading.start();\n         businessname = target.businessname.value;\n         busTagLine= target.businesstagLine.value;\n         busLogo= target.imgBusLogo.src;\n         //busAvatar= target.imgBusAvatar.src;\n         bustel= target.bustell.value;\n         buscel= target.buscell.value;\n         busemail= target.busemail.value;\n         cont1 = target.person1.value;\n         cont2 = target.person2.value;\n         add1= target.add1.value;\n         add2= target.add2.value;\n         add3= target.add3.value;\n         add4= target.add4.value;\n         add5= target.add5.value;\n         website= target.website.value;\n\n\n         var busLogoFile = target.fileLogo.files;\n         var randLogoId = Random.id();\n         var buslogImdId = Random.id();      \n      \n         if (busLogoFile.length > 0)\n         {\n          var BuslogoImg = new FS.File(busLogoFile[0]);\n           \n            BuslogoImg.sellerId = Meteor.userId();\n            BuslogoImg.ImageCat = \"SellerDetails\";\n            BuslogoImg.ImageType = \"BusLogo\";\n            BuslogoImg.ImageId = randLogoId;\n            try {\n              Images.insert(BuslogoImg, function (err, fileObj) {\n                if (err)\n                {\n             \n                }\n                // Inserted new doc with ID fileObj._id, and kicked off the data upload using HTTP\n              });      \n              \n            } catch (error) {\n              \n            }\n              \n           \n         }\n        \n       \n       createDate = Date.now().toLocaleString();\n\n      if (target.currentuser === null)\n      {\n          alert('You must be logged in to be a seller');\n          return false;\n      }\n     \n      var SellerObj = {\n          //_id:this._id,\n           userId:Meteor.userId(),\n           businessname : target.businessname.value,\n           busTagLine: target.businesstagLine.value,\n           busLogo: randLogoId,\n           //busAvatar: randAvaId,\n           bustel: target.bustell.value,\n           buscel: target.buscell.value,\n           busemail: target.busemail.value,\n           cont1 : target.person1.value,\n           cont2 : target.person2.value,\n           add1: target.add1.value,\n           add2: target.add2.value,\n           add3: target.add3.value,\n           add4: target.add4.value,\n           add5: target.add5.value,\n           website: target.website.value\n\n      }\n\n     // Loading.start();\n      \n  var result =  Meteor.call(\n    'newSeller',\n    SellerObj,\n    (err) =>\n            {\n                if (err)\n                {\n                    console.log(err);\n                    alert('OOps something went wrong adding new seller, please retry .');\n                }\n                else\n                {\n                    //clean up form   \n                    try\n                    {\n                    \n                    }\n                    catch (exp)\n                    {\n                        console.log(exp);\n                    }\n                }\n            });\n\n            Loading.stop();\n  \n  }\n});\n\n \n\n \n\n\n\n  \n  function HandleClientImageFile(file,targetElement)\n  {\n    var preview = document.querySelector(\"#\" + targetElement);\n    var fr = new FileReader();\n   \n    //insertImg.name=\"imgprds\";\n  \n    if (file.name === null)\n    {\n      return null;\n    }\n  \n     \n    fr.onload =function(event)\n    {\n      var data = event.target.result;\n      var insertImg = new Image();\n      insertImg.id = \"prdImages\";\n      //insertImg.style =\"height=100%;width=100%\"; \n      insertImg.className=\"prdImages img-responsive\";    \n      insertImg.src = data;\n     \n      \n\n      var image = new Image();\n      var compressedImage = new Image();\n      image.onload = function() {\n        var canvas = document.createElement(\"canvas\");\n        canvas.width = insertImg.naturalWidth;       \n        canvas.height = insertImg.naturalHeight;        \n       var ctx = canvas.getContext(\"2d\").drawImage(insertImg, 0, 0);//,insertImg.naturalWidth,insertImg.naturalHeight, 0, 0,insertImg.naturalWidth,insertImg.naturalHeight);\n       compressedImage.width =  insertImg.naturalWidth;\n       compressedImage.height = insertImg.naturalHeight;\n        var compressValue = 1/100;\n       switch(true) {\n        case (file.size < 400000):\n            compressValue = 100/100;\n            break;\n        case (file.size < 800000):\n            compressValue = 80/100;\n            break;\n        case (file.size < 2000000):\n            compressValue = 60/100;\n            break;\n        case (file.size < 4000000):\n            compressValue = 40/100;\n            break;    \n        case (file.size < 6000000):\n            compressValue = 20/100;\n            break;     \n        default:\n        compressValue = 10/100;\n        break;     \n    }\n\n       compressedImage = canvas.toDataURL(\"image/jpeg\", compressValue);\n       var newImg  = new Image(); \n        //newImg.height =1000;\n        newImg.id = \"prdImages\";\n        newImg.src = compressedImage;\n        newImg.className=\"prdImages img-responsive\"; \n        preview.appendChild(newImg); \n      };\n      image.src = data;\n\n \n\n       \n      //var compImage = compressImage(image,40,\"jpg\");\n      \n      //insertImg.src = data;    \n      //preview.appendChild(insertImg);    \n      \n\n    }\n  \n    fr.readAsDataURL(file);\n     \n    \n  }\n\n  function compressImage(source_img_obj, quality, output_format){\n             \n    var mime_type = \"image/jpeg\";\n    if(typeof output_format !== \"undefined\" && output_format==\"png\"){\n       mime_type = \"image/png\";\n    }\n    \n\n    var cvs = document.createElement('canvas');\n    cvs.style.width = source_img_obj.naturalWidth;\n    cvs.style.height = source_img_obj.naturalHeight;\n \n    //ctx.drawImage(img,0,0,img.width,img.height,0,0,400,300);\n    var ctx = cvs.getContext(\"2d\").drawImage(source_img_obj, 0, 0,source_img_obj.naturalHeight,source_img_obj.naturalWidth, 0, 0,source_img_obj.naturalHeight,source_img_obj.naturalWidth);\n    var newImageData = cvs.toDataURL(mime_type, quality/100);\n    var result_image_obj = new Image();\n    result_image_obj.src = newImageData;\n    result_image_obj.style.height = source_img_obj.naturalWidth;\n    result_image_obj.style.width = source_img_obj.naturalHeight;\n\n    return result_image_obj; \n}\n\n  function HandleClientImageData(file,targetElement)\n  {\n    var preview = document.querySelector(\"#\" + targetElement);\n     \n \n    //insertImg.name=\"imgprds\";\n  \n    if (file === null)\n    {\n      return null;\n    }\n  \n     \n    \n      var data = file;\n      var insertImg = new Image();\n      insertImg.id = \"prdImages\";\n      insertImg.style =\"height=100%;width=100%\"; \n      insertImg.className=\"prdImages img-responsive\";    \n      insertImg.src = data;    \n      preview.appendChild(insertImg);    \n    \n     \n    \n  }\n  \n  \n  \n  \n  \n  if (Meteor.isClient)\n  {\n  \n\n    \n   \n  \n  Template.tmp_product_sell.events({\n    'submit .product-link-add'(event) {\n      var thisForm = $('.product-link-add');\n      thisForm.validate();\n      event.preventDefault();\n        \n      try {\n      \n\n \n        var productImages = event.target.prodImg.files;\n        var compressedImages = $('.prdImages');\n        var prodimgId = Random.id();\n        var saveId;        \n        if (productImages.length > 0)\n        {\n          \n          for (var i =0;i < productImages.length ; i  ++)\n          {\n            var fr = new FS.File(compressedImages[i].src);\n\n             \n          \n                    Loading.start();\n                    var productImg = new FS.File(productImages[i]);\n                    fr.name = productImg.name;\n                    fr.extension = productImg.extension;\n                    fr.type = productImg.type;\n                    fr.sellerId = Meteor.userId();\n                    fr.ImageCat = \"ProductImage\";\n                    fr.ImageType = \"ProductDisplay\";\n                    fr.ImageId = prodimgId ;\n                    //template.$('.imgBusLogo')[0].src = data;    \n                    saveId = Images.insert(fr, function (err, fileObj) {\n                      // Inserted new doc with ID fileObj._id, and kicked off the data upload using HTTP\n                      });\n                      Loading.stop();\n            \n           \n            // var productImg = new FS.File(productImages[i]);\n            // // if (productImg.size() < 1000000)\n            // // {\n            //   productImg.data = compressedImages[i].src;\n            //   productImg.sellerId = Meteor.userId();\n            //   productImg.ImageCat = \"ProductImage\";\n            //   productImg.ImageType = \"ProductDisplay\";\n            //   productImg.ImageId = prodimgId ;\n\n               \n             \n\n             \n            // }\n        }  \n        }\n        \n       \n        \n      } catch (error) {\n        console.log(\"Error inserting Product Images\");\n        Loading.halt();\n      }\n     \n      var ImagesInserted = prodimgId;\n       \n  \n      //debugger;\n      \n      const target = event.target;\n      const title = target.prdTitle.value;\n      const description = target.prdDesc.value;\n      const img = ImagesInserted;\n      const price = target.prdprice.value;\n      const prdCat = target.prdCat.value;\n      const createDate =  new Date();\n      const expireValue = target.prdExpire.value;\n      const expireDate = new Date();\n      \n       \n      console.log(description);\n  \n   \n        var timetoadd = ReferenceData.findOne({name:\"addTime\",id:expireValue}).timetoadd;\n    \n        var expDate = new Date();//Date.parse(expDate.format());// moment().add(timetoadd,'days');\n        var myExpDate =new Date();// Date.parse(expDate.format());\n  \n        var prodObj =\n        {\n          sellerId:Meteor.userId(),\n          producttitle:title,    \n          productDescription:description,\n          price:price,\n          prdCat:prdCat,\n          prodImg : img,\n          createdAt:createDate,\n          expireAt : new Date(myExpDate) \n        }\n       \n       // Here we need to get the images that have been selected to be uploaded to the server\n        \n      \n  \n        try {\n          Loading.call(\"products.insert\", prodObj, [], [], function (error, result){\n            if (error)\n            {\n              alert('Something went wrong. Please try again.')\n            }\n            else\n            {\n              //clear form.\n            }\n          });\n                   \n        } catch (error) {\n          console.log(\"Error Inserting product\");\n  \n          \n        }\n        \n   \n   \n      \n  \n    }\n  });\n  \n  }"]},"sourceType":"script","hash":"8b76914414cdb8ecd89f0f3d7296ea639f5f1eb4"}
